{% extends 'base.html' %}

{% block title %}
    Welcome to ma3ana kam | sa7e7 e7na ma3ana kam
{% endblock %}

{% block content %}

    {% if not period %}
        <h3>
           There is no period for Today, please go
            <a href='{% url 'add_period' %}'>here</a>
            to add and configure one.
            </p>
        </h3>
    {% else %}
        <div class="panel panel-primary">
            <div class="panel-body">
                <h3>Period</h3>
            </div>
            <div class="panel-footer">
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0"
                         aria-valuemax="100" style="width: {{ period.remaining_percentage }}%;">
                        {{ period.remaining_percentage }}%
                    </div>
                </div>
                <div class="form-group">
                    <label for="period-desc">Description</label>
                    <input type="text" class="form-control" id="period-desc" value="{{ period.description }}"
                           disabled>
                </div>

                <div class="form-group">
                    <label for="period-start-date">Start Date</label>
                    <input type="text" class="form-control" id="period-start-date" value="{{ period.start_date }}"
                           disabled>
                </div>
                <div class="form-group">
                    <label for="period-end-date">End Date</label>
                    <input type="text" class="form-control" id="period-end-date" value="{{ period.end_date }}"
                           disabled>
                </div>
                <div class="form-group">
                    <label for="period-amount">Amount</label>

                    <div class="input-group">
                        <div class="input-group-addon">KWD</div>
                        <input type="text" class="form-control" id="period-amount" value="{{ period.amount }}"
                               disabled>
                    </div>
                </div>

                <div class="form-group">
                    <label for="period-amount">Remaining Amount</label>
                     <div class="input-group">
                        <div class="input-group-addon">KWD</div>
                        <input type="text" class="form-control" id="period-remaining-amount"
                               value="{{ period.remaining_amount }}" disabled>
                    </div>
                </div>

                <div class="form-group">
                    <a class="btn btn-primary btn-xs" href="{% url 'update_period' period.id %}">Edit</a>
                    <a class="btn btn-danger btn-xs" href="{% url 'delete_period' period.id %}">Delete</a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <h2>Expenses</h2>
            </div>

            <div class="col-sm-6" style="margin-top: 14px">
                <a href="{% url 'add_expense' %}" class="btn btn-default pull-right">
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                    Add Expense</a>
            </div>

        </div>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>
                    Date
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Description
                </th>
                <th>

                </th>
            </tr>
            </thead>
            <tbody>
            {% for expense in expenses %}
                <tr>
                    <td>
                        {{ expense.date }}
                    </td>
                    </td>
                    <td>
                        {{ expense.amount }}
                    </td>
                    <td>
                        {{ expense.description }}
                    </td>
                    <td>
                        <a class="btn btn-primary btn-xs" href="{% url 'update_expense' expense.id %}">Edit</a>
                        <a class="btn btn-danger btn-xs" href="{% url 'delete_expense' expense.id %}">Delete</a>
                    </td>
                </tr>
            {% endfor %}
            <tr>
                <td><b>Total</b></td>
                <td><b>{{ period.get_expense_total }}</b></td>
                <td></td>
                <td></td>
            </tr>
            </tbody>
        </table>

    {% endif %}

{% endblock %}

{% block script %}
    <script type="application/javascript">
       $(document).ready(function(){
           var remainingPercentage = 100 - {{ period.remaining_percentage }}
           var progressBar = $('.progress-bar');

         if(remainingPercentage <= 20){
             progressBar.addClass('progress-bar-danger');
         }else if(remainingPercentage >= 21 && remainingPercentage <= 40){
             progressBar.addClass('progress-bar-warning');
         }else if(remainingPercentage >= 41 && remainingPercentage <= 60){
             progressBar.addClass('progress-bar-success');
         }else if(remainingPercentage >= 61 && remainingPercentage <= 100){
             progressBar.addClass('progress-bar-info');
         }else{
             progressBar.addClass('progress-bar-info');
         }
       });
    </script>

{% endblock %}
