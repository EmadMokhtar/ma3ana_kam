{% extends 'base.html' %}
{% block title %}
    Welcome to ma3ana kam | sa7e7 e7na ma3ana kam
{% endblock %}

{% block content %}

    {% if not period %}

        <h3>
            There is no period for Today, please go
            <a href='{% url 'add_period' %}'>here</a>
            to add and configure one.
            </p>
        </h3>
    {% else %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3>
                    Period
                    <div class="btn-group pull-right">
                        <a class="btn btn-primary" href="{% url 'update_period' period.id %}">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </a>
                        <a class="btn btn-danger" href="{% url 'delete_period' period.id %}">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </a>
                    </div>
                </h3>
            </div>
            <div class="panel-body">
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0"
                         aria-valuemax="100" style="width: {{ period.remaining_percentage }}%;">
                        {{ period.remaining_percentage | floatformat:-2 }}%
                    </div>
                </div>
                <div class="form-group">
                    <label for="period-desc">Description</label>
                    <input type="text" class="form-control" id="period-desc" value="{{ period.description }}"
                           disabled>
                </div>

                <div class="form-group">
                    <label for="period-start-date">Start Date</label>
                    <input type="text" class="form-control" id="period-start-date" value="{{ period.start_date |date:'d F Y' }}"
                           disabled>
                </div>
                <div class="form-group">
                    <label for="period-end-date">End Date</label>
                    <input type="text" class="form-control" id="period-end-date" value="{{ period.end_date|date:'d F Y' }}"
                           disabled>
                </div>
                <div class="form-group">
                    <label for="period-amount">Amount</label>

                    <div class="input-group">
                        <div class="input-group-addon">KWD</div>
                        <input type="text" class="form-control" id="period-amount" value="{{ period.amount }}"
                               disabled>
                    </div>
                </div>

                <div class="form-group">
                    <label for="period-amount">Remaining Amount</label>

                    <div class="input-group">
                        <div class="input-group-addon">KWD</div>
                        <input type="text" class="form-control" id="period-remaining-amount"
                               value="{{ period.remaining_amount }}" disabled>
                    </div>
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <h2>Expenses</h2>
            </div>

        </div>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>
                    Date
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Description
                </th>
                <th>
                </th>
            </tr>
            </thead>
            <tbody>
            {% for expense in expenses %}
                <tr>
                    <td>
                        {{ expense.date|date:'d/M/Y' }}
                    </td>
                    <td>
                        {{ expense.amount }}
                    </td>
                    <td>
                        {{ expense.description }}
                    </td>
                    <td>
                        <a href="{% url 'update_expense' expense.id %}">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </a>
                        <a href="{% url 'delete_expense' expense.id %}">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            <tr class="active">
                <td></td>
                <td><b>Total</b></td>
                <td><b>{{ period.get_expense_total }}</b></td>
                <td></td>
            </tr>
            </tbody>
        </table>

    {% endif %}

{% endblock %}

{% block script %}
    <script type="application/javascript">
        $(document).ready(function () {
            var remainingPercentage = 100 -
            {{ period.remaining_percentage }}
            var progressBar = $('.progress-bar');

            if (remainingPercentage <= 20) {
                progressBar.addClass('progress-bar-danger');
            } else if (remainingPercentage >= 21 && remainingPercentage <= 40) {
                progressBar.addClass('progress-bar-warning');
            } else if (remainingPercentage >= 41 && remainingPercentage <= 60) {
                progressBar.addClass('progress-bar-success');
            } else if (remainingPercentage >= 61 && remainingPercentage <= 100) {
                progressBar.addClass('progress-bar-info');
            } else {
                progressBar.addClass('progress-bar-info');
            }
        });
    </script>

{% endblock %}
